#include "state_space.h"
#include "util.h"
#include "string.h"

float Stool_A_init[4*4] = {
    1.f, 0.0001f, 0.0020f, 0,
    0, 1.0003f, 0, 0.0020f,
    0, 0.0877f, 1.f, 0.0001f,
    0, 0.2651f, 0, 1.0003f
}; 
float Stool_B_init[4*1] = {
    0,
    0,
    0.0014f,
    0.0034f
};
float Stool_C_init[4*4] = {
    1, 0, 0, 0,
    0, 1, 0, 0,
    0, 0, 1, 0,
    0, 0, 0, 1
}; 
float Stool_D_init[4*1] = {
    0
};
float LegW_A_init[6*6] = {
1.000128f, 0.002000f, 0.000000f, 0.000000f, 0.000002f, 0.000000f,
0.128119f, 1.000128f, 0.000000f, 0.000000f, 0.001548f, 0.000002f,
-0.000012f, -0.000000f, 1.000000f, 0.002000f, 0.000000f, 0.000000f,
-0.012432f, -0.000012f, 0.000000f, 1.000000f, 0.000009f, 0.000000f,
0.000016f, 0.000000f, 0.000000f, 0.000000f, 1.000017f, 0.002000f,
0.016317f, 0.000016f, 0.000000f, 0.000000f, 0.017267f, 1.000017f,
};
float LegW_B_init[6*2] = {
    -0.0001f,0.0000f,
    -0.0951f,0.0374f,
    0.0000f,-0.0000f,
    0.0189f,-0.0032f,
    -0.0000f,0.0001f,
    -0.0038f,0.0514f
};
float LegW_C_init[6*6] = {
    1, 0, 0, 0, 0, 0,
    0, 1, 0, 0, 0, 0,
    0, 0, 1, 0, 0, 0,
    0, 0, 0, 1, 0, 0,
    0, 0, 0, 0, 1, 0,
    0, 0, 0, 0, 0, 1
};
float LegW_D_init[6*2] = {
    0
};

void fitting_Stool_A(float A_fit[4*4], float L0){
    float x = L0;
    float _A_fit[4][4] = {
    {0.000000000000042359673250178013663f*x - 0.00000000000015245479747783890988f*pow2f(x) + 0.00000000000017508662135262808001f*pow3f(x) + 1.0f, 0.00000054646315058583480278f*pow2f(x) - 0.00000019757739984507761249f*x - 0.00000053600446723451942808f*pow3f(x) + 0.000087684928575154603503f, 0.000000000000000082733736816753932935f*x - 0.00000000000000029776327632390412086f*pow2f(x) + 0.00000000000000034196605732935171877f*pow3f(x) + 0.002f, 0.00000000021857704424391155752f*pow2f(x) - 0.000000000079028296281734882219f*x - 0.00000000021439325474976785529f*pow3f(x) + 0.000000058448679970853338245f},
    {0.0f, 0.037412811839993238838f*pow2f(x) - 0.013526576130237324622f*x - 0.036697198493748549308f*pow3f(x) + 1.0020380590302344626f, 0.0f, 0.000024938593811739953658f*pow2f(x) - 0.0000090166537916307000814f*x - 0.000024461391997503567646f*pow3f(x) + 0.0020013585846109455471f},
    {0.0f, 0.0010929981925283417665f*pow2f(x) - 0.00039517810712605839357f*x - 0.001072083592275500279f*pow3f(x) + 0.0877147016426261944f, 0.000000000000042359673250178013663f*x - 0.00000000000015245479747783890988f*pow2f(x) + 0.00000000000017508662135262808001f*pow3f(x) + 1.0f, 0.00000054646315057736659089f*pow2f(x) - 0.00000019757739984275637163f*x - 0.00000053600446722509057495f*pow3f(x) + 0.000087684928575154400215f},
    {0.0f, 37.425115266904562361f*pow2f(x) - 13.530564927606132386f*x - 36.70997540416555438f*pow3f(x) + 2.0385143342861691274f, 0.0f, 0.037412811839993238838f*pow2f(x) - 0.013526576130237324622f*x - 0.036697198493748549308f*pow3f(x) + 1.0020380590302344626f}
};
memcpy(A_fit, _A_fit, sizeof(_A_fit));
}
void fitting_Stool_B(float B_fit[4*1], float L0){
    float x = L0;
    float _B_fit[4][1] = {
    {0.0000000069672858181714852329f*pow2f(x) - 0.000000002519068695613461281f*x - 0.0000000068339398896398350192f*pow3f(x) + 0.000001367433564820206164f},
    {0.00047700517973244807232f*pow2f(x) - 0.00017246089135871268266f*x - 0.000467881265863320957f*pow3f(x) + 0.000025984807508650950255f},
    {0.000013935488235936835822f*pow2f(x) - 0.0000050384345560753820173f*x - 0.00001366883165059950677f*pow3f(x) + 0.0013678131649278195067f},
    {0.47716204573597087446f*pow2f(x) - 0.17251174765330035132f*x - 0.46804416867779002898f*pow3f(x) + 0.025990612535808511885f}
};
memcpy(B_fit, _B_fit, sizeof(_B_fit));
}

void fitting_LegW_A(float A_fit[6*6],float L0){
    float x = L0;
    float _A_fit[6][6] = {
    {0.0079745556025872816469f*pow2f(x) - 0.0024972386123461474614f*x - 0.0096535928113067499823f*pow3f(x) + 1.0004044569779229068f, 0.0000053162670338017560534f*pow2f(x) - 0.0000016647909250315900282f*x - 0.0000064356173792670638706f*pow3f(x) + 0.002000269633294915906f, 0.0f, 0.0f, 0.00016584197527683239726f*pow2f(x) - 0.000048896372635552759196f*x - 0.00020319258932075643536f*pow3f(x) + 0.0000065795894047198820445f, 0.00000011055949261962711568f*pow2f(x) - 0.000000032596991156215193902f*x - 0.00000013545972457183144112f*pow3f(x) + 0.0000000043863183664529996794f},
    {7.9749432353639662097f*pow2f(x) - 2.497369175437769151f*x - 9.6540096703194659966f*pow3f(x) + 0.40447456693871874922f, 0.0079745556025872816469f*pow2f(x) - 0.0024972386123461474614f*x - 0.0096535928113067499823f*pow3f(x) + 1.0004044569779229068f, 0.0f, 0.0f, 0.16584881621234254245f*pow2f(x) - 0.048898587410485132299f*x - 0.20320009554862006329f*pow3f(x) + 0.0065798690448631048933f, 0.00016584197527683242437f*pow2f(x) - 0.000048896372635552759196f*x - 0.00020319258932075648957f*pow3f(x) + 0.0000065795894047198811975f},
    {0.0000012117986828583216417f*x - 0.00018930723311049078524f*pow2f(x) + 0.00038544466359940663096f*pow3f(x) - 0.000007185052734826449939f, 0.0000000008073118194511252536f*x - 0.00000012620238180561993128f*pow2f(x) + 0.00000025695916095879668442f*pow3f(x) - 0.0000000047899153711295666095f, 0.000000000000042359673250178013663f*x - 0.00000000000015245479747783890988f*pow2f(x) + 0.00000000000017508662135262808001f*pow3f(x) + 1.0f, 0.000000000000000082733736816753932935f*x - 0.00000000000000029776327632390412086f*pow2f(x) + 0.00000000000000034196605732935171877f*pow3f(x) + 0.002f, 0.0000019867099733907871618f*x - 0.000010863647860264541119f*pow2f(x) + 0.000016805216076715154077f*pow3f(x) - 0.000000077265422760318087785f, 0.0000000013244579805873626432f*x - 0.0000000072423674245298508981f*pow2f(x) + 0.000000011203382718747711786f*pow3f(x) - 0.000000000051508126419816910634f},
    {0.0012138760933864364052f*x - 0.18931638419114912852f*pow2f(x) + 0.38545946909166944883f*pow3f(x) - 0.0071855019347161668344f, 0.0000012117986828577384595f*x - 0.00018930723311048869816f*pow2f(x) + 0.00038544466359940419151f*pow3f(x) - 0.0000071850527348263923408f, 0.0f, 0.000000000000042359673250178013663f*x - 0.00000000000015245479747783890988f*pow2f(x) + 0.00000000000017508662135262808001f*pow3f(x) + 1.0f, 0.0019867674801762611261f*x - 0.010863889670527388659f*pow2f(x) + 0.01680557107509041137f*pow3f(x) - 0.000077273505662666446491f, 0.0000019867099733907871618f*x - 0.000010863647860264542813f*pow2f(x) + 0.000016805216076715157465f*pow3f(x) - 0.000000077265422760318153959f},
    {0.0011868019553284325958f*pow2f(x) - 0.00021745349383336720411f*x - 0.0018347401596624857752f*pow3f(x) + 0.000025809147664032128006f, 0.00000079119425049811852086f*pow2f(x) - 0.00000014496731756583374719f*x - 0.0000012231497598706549658f*pow3f(x) + 0.000000017205849942802886444f, 0.0f, 0.0f, 0.000020886762416206078568f*pow2f(x) - 0.0000042345666470981650897f*x - 0.000031160276077639868157f*pow3f(x) + 1.0000175168197573683f, 0.000000013924375400987536224f*pow2f(x) - 0.0000000028230118391314120516f*x - 0.000000020773330307772679919f*pow3f(x) + 0.0020000116778626582555f},
    {1.186828404454924657f*pow2f(x) - 0.21745978760069437086f*x - 1.8347789595100014726f*pow3f(x) + 0.025810079546906505854f, 0.0011868019553284304274f*pow2f(x) - 0.0002174534938333666349f*x - 0.0018347401596624827395f*pow3f(x) + 0.000025809147664032073795f, 0.0f, 0.0f, 0.020887260028979785093f*pow2f(x) - 0.0042346886907467891012f*x - 0.031160976792466769242f*pow3f(x) + 0.017516884166751262031f, 0.000020886762416206078568f*pow2f(x) - 0.0000042345666470981650897f*x - 0.000031160276077639868157f*pow3f(x) + 1.0000175168197573683f}
};
memcpy(A_fit, _A_fit, sizeof(_A_fit));
}
void fitting_LegW_B(float B_fit[6*2],float L0){
    float x = L0;
    float _B_fit[6][2] = {
    {0.0042706645755701891365f*x - 0.013309049788089605607f*pow2f(x) + 0.014689337808405093094f*pow3f(x) - 0.00055747064263577273541f, 0.0099418557883370339834f*pow2f(x) - 0.0032064475620757083157f*x - 0.01062101491101523007f*pow3f(x) + 0.00038079526100298947359f},
    {4.2708563192086144156f*x - 13.309641886448838832f*pow2f(x) + 14.689966947246356099f*pow3f(x) - 0.55749326907701202138f, 9.9422802829609580044f*pow2f(x) - 3.2065825653520305671f*x - 10.621464290657945284f*pow3f(x) + 0.38081018328854510102f},
    {0.00028593061087297513747f*pow2f(x) - 0.000061901702980808793629f*x - 0.00042073386871236540105f*pow3f(x) + 0.000023193243005330816515f, 0.000067704632979538576605f*x - 0.00022829606847196492548f*pow2f(x) + 0.00028627806945905580208f*pow3f(x) - 0.000010332120831976003461f},
    {0.28594465576630129222f*pow2f(x) - 0.061905956015779042834f*x - 0.4207513508544834524f*pow3f(x) + 0.023193899110634519367f, 0.067708054892816338377f*x - 0.22830641518713168381f*pow2f(x) + 0.28628945171658110036f*pow3f(x) - 0.010332583213613131742f},
    {0.00023779515918894301562f*x - 0.0010231150093236412568f*pow2f(x) + 0.0014370245922073231811f*pow3f(x) - 0.000022019249751369837214f, 0.00050978186329820142971f*pow2f(x) - 0.00014505099515175145196f*x - 0.00063979889681508412495f*pow3f(x) + 0.000065784798326264448741f},
    {0.23780422485141725075f*x - 1.0231463808800131954f*pow2f(x) + 1.4370637225765825473f*pow3f(x) - 0.022020437550246879654f, 0.50980189748170012809f*pow2f(x) - 0.14505737467044937938f*x - 0.63982130170138529213f*pow3f(x) + 0.065785737591238846456f}
};
memcpy(B_fit, _B_fit, sizeof(_B_fit));
}
